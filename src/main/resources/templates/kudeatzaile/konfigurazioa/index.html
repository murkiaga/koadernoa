<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="eu">
<head>
  <meta charset="UTF-8">
  <title>Konfigurazioa</title>
  <link rel="stylesheet" th:href="@{/css/navbar.css}">
  <style>
    :root { --b: #e5e7eb; --t: #111827; --m: #2563eb; --bg: #fff; }
    body { color: var(--t); background: var(--bg); }
    .tabs { display:flex; gap:.5rem; border-bottom:1px solid var(--b); margin:16px 0; }
    .tab-btn { border:none; background:none; padding:10px 14px; cursor:pointer; border-bottom:3px solid transparent; }
    .tab-btn[aria-selected="true"] { border-color: var(--m); font-weight:600; }
    .tab-panel { display:none; padding-top:16px; }
    .tab-panel.active { display:block; }
    table { border-collapse: collapse; width:100%; }
    th, td { border-bottom:1px solid var(--b); padding:8px; text-align:left; }
    th { background:#f9fafb; }
    .row { display:grid; gap:12px; grid-template-columns: 1fr 1fr 1fr auto; align-items:center; }
    .row > * { width:100%; }
    .muted { color:#6b7280; font-size:.9rem; }
    .actions { margin-top:12px; }
    .section { margin: 24px 0; }
  </style>
</head>
<body>
<div th:replace="/kudeatzaile/fragments/navbar :: kudeatzaile-navbar"></div>

<h1>Konfigurazioa</h1>

<!-- Tab botoiak -->
<div class="tabs" role="tablist" aria-label="Konfigurazio atalak">
  <button class="tab-btn" role="tab" aria-selected="true" aria-controls="panel-mailak" id="tab-mailak">Mailak</button>
  <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-bestek" id="tab-bestek">TBD</button>
</div>

<!-- Mailak PANELA -->
<section id="panel-mailak" class="tab-panel active" role="tabpanel" aria-labelledby="tab-mailak" tabindex="0">
  <h2>Mailak</h2>
  <p class="muted">Aktibatu/desaktibatu checkbox bidez. Azpian, maila berria sor dezakezu.</p>

  <!-- Aktibo/desaktibo bulk form -->
  <form th:action="@{/kudeatzaile/konfigurazioa/mailak/aktiboak}" th:object="${activeForm}" method="post">
    <table>
      <thead>
      <tr>
        <th>Aktibo</th>
        <th>Ordena</th>
        <th>Kodea</th>
        <th>Izena</th>
        <th>ID</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="m : ${mailak}">
        <td>
          <input type="checkbox"
                 th:name="|aktiboIds|"
                 th:value="${m.id}"
                 th:checked="${m.aktibo}">
        </td>
        <td th:text="${m.ordena}">1</td>
        <td th:text="${m.kodea}">LEHENENGOA</td>
        <td th:text="${m.izena}">1. maila</td>
        <td th:text="${m.id}">1</td>
      </tr>
      </tbody>
    </table>
    <div class="actions">
      <button type="submit">Gorde aktiboak</button>
    </div>
  </form>

  <h3 style="margin-top:24px;">Sortu maila berria</h3>
  <form th:action="@{/kudeatzaile/konfigurazioa/mailak/sortu}" th:object="${sortuForm}" method="post">
    <div class="row">
      <label>
        <div class="muted">Kodea</div>
        <input type="text" th:field="*{kodea}" placeholder="LEHENENGOA" required>
      </label>
      <label>
        <div class="muted">Izena</div>
        <input type="text" th:field="*{izena}" placeholder="1. maila">
      </label>
      <label>
        <div class="muted">Ordena</div>
        <input type="number" th:field="*{ordena}" min="0" placeholder="1" required>
      </label>
      <div style="align-self:end;">
        <button type="submit">Sortu</button>
      </div>
    </div>
  </form>
</section>

<!-- Etorkizuneko panelak: -->
<section id="panel-bestek" class="tab-panel" role="tabpanel" aria-labelledby="tab-bestek" tabindex="0" aria-hidden="true">
  <h2>Bestelako aukerak</h2>
  <p class="muted">Atal hau etorkizunean osatuko da.</p>
</section>

<script>
  // Tabs JS minimoa
  (function() {
    const tabs = document.querySelectorAll('.tab-btn');
    const panels = document.querySelectorAll('.tab-panel');
    tabs.forEach(btn => btn.addEventListener('click', () => {
      if (btn.disabled) return;
      tabs.forEach(b => b.setAttribute('aria-selected', 'false'));
      panels.forEach(p => { p.classList.remove('active'); p.setAttribute('aria-hidden','true'); });
      btn.setAttribute('aria-selected', 'true');
      const panel = document.getElementById(btn.getAttribute('aria-controls'));
      panel.classList.add('active');
      panel.removeAttribute('aria-hidden');
      panel.focus();
      // hash-a eguneratu (nahi baduzu)
      history.replaceState(null, '', '#' + btn.id.replace('tab-',''));
    }));
    // Hash bidez hasieratu (aukera)
    const hash = location.hash.replace('#','');
    if (hash) {
      const to = document.getElementById('tab-' + hash);
      if (to && !to.disabled) to.click();
    }
  })();
</script>
</body>
</html>
